<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Owner Requests - Room Rental System</title>
    <style>
        /* CSS from my_rooms.html */
        body { font-family: Arial, sans-serif; background: #f5f5f5; margin: 0; }
        .navbar { background: #2c3e50; color: white; padding: 15px 30px; display: flex; justify-content: space-between; align-items: center; }
        .navbar a { color: white; text-decoration: none; margin-left: 20px; }
        .navbar a:hover { color: #f39c12; }
        .container { max-width: 1200px; margin: 40px auto; padding: 25px; }
        h2 { color: #2c3e50; margin-bottom: 20px; }
        table { width: 100%; border-collapse: collapse; background: white; box-shadow: 0 4px 10px rgba(0,0,0,0.1); border-radius: 8px; overflow: hidden; }
        th, td { padding: 12px 15px; text-align: left; border-bottom: 1px solid #ddd; font-size: 14px; }
        th { background: #ecf0f1; color: #333; }
        
        /* Status Highlighting */
        .pending { background-color: #fcf8e3; }
        .approved { background-color: #d9edf7; }
        .rejected { background-color: #f2dede; }
        .verified { background-color: #dff0d8; }
        
        .actions button, .actions a { padding: 5px 10px; border-radius: 4px; border: none; color: white; cursor: pointer; margin-right: 5px; font-size: 13px; }
        .approve { background: #5cb85c; }
        .reject { background: #d9534f; }
        .view-doc { background: #3498db; }
    </style>
</head>
<body>
    <div class="navbar">
        <h2>Booking Requests</h2>
        <div>
            <a href="{{ url_for('dashboard') }}">Dashboard</a>
            <a href="{{ url_for('my_rooms') }}">My Listings</a>
        </div>
    </div>

    <div class="container">
        <h2>Requests for Your Rooms</h2>
        
        <table>
            <thead>
                <tr>
                    <th>Room Address</th>
                    <th>Capacity</th>
                    <th>Requester</th>
                    <th>Contact</th>
                    <th>Status</th>
                    <th>People</th>
                    <th>Documents</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for req in requests %}
                <tr class="{{ req.request_status }}">
                    <td>{{ req.address }} ({{ req.room_type }})</td>
                    <td>Max: {{ req.max_people }}</td>
                    <td>{{ req.requester_username }}</td>
                    <td>
                        Email: {{ req.requester_email }}<br>
                        Mobile: {{ req.requester_mobile }}
                    </td>
                    <td>
                        <strong>{{ req.request_status|upper }}</strong>
                    </td>
                    <td>{{ req.num_people_booking }}</td>
                    <td>
                        {% if req.request_status == 'verified' %}
                            <span style="color: #27ae60;">{{ req.uploaded_docs_count }} / {{ req.num_people_booking }} Uploaded</span>
                        {% else %}
                            <span style="color: #e67e22;">0 / {{ req.num_people_booking }}</span>
                        {% endif %}
                    </td>
                    <td class="actions">
                        {% if req.request_status == 'pending' %}
                            <form method="POST" action="{{ url_for('respond_request', booking_id=req.id, action='approve') }}" style="display:inline;">
                                <button type="submit" class="approve">Approve</button>
                            </form>
                            <form method="POST" action="{{ url_for('respond_request', booking_id=req.id, action='reject') }}" style="display:inline;">
                                <button type="submit" class="reject">Reject</button>
                            </form>
                        
                        {% elif req.request_status == 'verified' %}
                            <a href="{{ url_for('view_documents', booking_id=req.id) }}" class="view-doc" style="background: #3498db; color: white;">
                                View Docs ({{ req.uploaded_docs_count }})
                            </a>
                        {% endif %}
                    </td>
                </tr>
                {% else %}
                <tr><td colspan="8">No pending or active booking requests for your rooms.</td></tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</body>
</html>